{% include 'page_start.html' %}
<!-- nav_bar -->
{% include 'nav_bar.html' %}
<!-- /nav_bar -->
<div class="container">
    <h2>
        <!-- title -->
        {{ title }}
        <!-- /title -->
        {% if feedLink %}
        <!-- feedLink -->
        <small class="pull-right"> <a href="{{ feedLink }}">
                Subscribe <i class="icon-rss"></i>
            </a>
        </small>
        <!-- /link  -->
        {% endif %}
    </h2>

    <ul class="nav nav-pills">
        <li class="{% if not failuresOnly and not isEntry %}active{% endif %}">
            <a href="/status/?">Show all</a>
        </li>
        <li class="{% if failuresOnly %}active{% endif %}">
            <a href="/status/?failures=T">Show errors only</a>
        </li>
    </ul>

    <!--StartDeleteIf:messages-->
    {% if not messages %}
    <div class="alert alert-success" role="alert">
        <strong>Well done! </strong> {% if failuresOnly %} There are no recent
        backups with errors. {% else %} There are no recent backups to display.
        {% endif %}
    </div>
    {% endif %}
    <!--EndDeleteIf:messages-->

    {% for message in messages %}
    <!--StartRepeat:messages-->
    {%if message.is_success %}
    <!--StartIncludeIf:isSuccess-->
    <h3 class="backupStatus_success">
        <a href="{{ message.link }}">Successful Backups for {{ message.date
            | datetime }}</a>
    </h3>
    <div>
        <p>The following backups have completed successfully:</p>
        <ul>
            {% for backup in message.backups %}
            <!--StartRepeat:backups-->
            <li>
                <a class="statusRepoLink" href="{{ url_for_browse(repo) }}">{{ backup.date
                    | datetime }} - {{ backup.repo }} - {{ backup.size |
                    filesize }}</a>
            </li>
            <!--EndRepeat:backups-->
            {% endfor %}
        </ul>
    </div>
    <!--EndIncludeIf:is_success-->
    {% else %}
    <!--StartDeleteIf:isSuccess-->
    <h3 class="backupStatus_failure">
        <a href="{{ message.link }}">Backup Completed with Errors:
            {{ message.repo }}</a>
    </h3>
    <div>
        <p>
            The backup to <strong>{{ message.repo }}</strong> on <strong>{{ message.date
                | datetime }}</strong> failed with the following errors:
        </p>
        <pre>{{ message.errors }}</pre>
        <p>Backup size: {{ message.size | filesize }}</p>
    </div>
    {% endif %}
    <!--/isSuccess-->

    <!--StartIncludeIf:repoErrors-->
    {% if message.repoErrors %}
    <p>There following repositories contain errors:</p>
    <ul>
        {% for repoError in repoErrors %}
        <!--StartRepeat:repoErrors-->
        <li>
            <a class="statusRepoLink" href="{{ repoError.repoLink }}">{{ repoError.repo
                }}: {{ repoError.error }}</a>
        </li>
        <!--EndRepeat:repoErrors-->
        {% endfor %}
    </ul>
    {% endif %}
    <!--EndIncludeIf:repoErrors-->
    {% endfor %}
    <!--EndRepeat:messages-->
</div>
{% include 'page_end.html' %}
